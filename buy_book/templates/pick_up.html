<!DOCTYPE html>
<html lang="en">
    <head>
        {% extends 'base.html' %} {% block content %} {% load static %}{% load humanize %}
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="{% static 'web_app/assets/css/styles.css' %}" />

        <title>Pick_Up</title>
    </head>
    <body>
        <br />
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="section-heading">
                        <div class="line-dec"></div>
                        <h1>í”½ì—… ì£¼ë¬¸</h1>
                        <div class="add_notice">
                            <p>ï¼Šë°”ë¡œ í”½ì—…ì´ í•„ìš”í•  ë•Œ, ë” ë¹ ë¥¸ ë°°ì†¡ì´ í•„ìš”í•  ë•Œ í”½ì—… ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ë³´ì„¸ìš”.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="pick-container">
            <div class="row">
                <div class="col-md-6">
                    <div class="pick_place">
                    <!-- <hr class="pick-hr" style="background-color: rgb(65, 105, 216);"> -->
                        <p>ğŸ“ í•œì–‘ì—¬ìëŒ€í•™êµ ì„œì </p>
                    </div>
                    <!-- <hr class="pick-hr" style="background-color: rgb(65, 105, 216);"> -->
                    <div class="pick-info">
                        <!-- <h2>í”½ì—… ì„œë¹„ìŠ¤</h2> -->
                        <!-- <p>ì£¼ë¬¸ ê°€ëŠ¥: {{ book.name }}</p> -->

                        <div class="row">
                            <div class="col-md-9">
                                <div class="won_box">
                                    <img class="book_img" src="{{ book.image.url }}" style="width: 30%" />
                                    <h6> âœ”ï¸ {{ book.name }}</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="pick-hr" style="background-color: black;">
                    <div class = "bag-container">
                        <div class="">
                            <div class="won_box">
                                <b>ë´‰íˆ¬</b>
                                <label>
                                    <input type="radio" id="not-selected" name="bag" value="not-selected" checked> ì„ íƒì•ˆí•¨
                                </label>
                                <label>
                                    <input type="radio" id="with-bag" name="bag" value="with-bag"> ë´‰íˆ¬(+100ì›)
                                </label>
                            </div>
                        </div>
                    </div>
                    <hr class="pick-hr">
                </div>

                <div class="col-md-6">
                    <div class="pick_buy_box">
                        <div class="pick_buy_box_won">
                            <div class="won_box">
                                <p style="margin-right: 10px">ìƒí’ˆ ê¸ˆì•¡</p>
                                <p><b>{{ book.amount|intcomma }}</b> ì›</p>
                            </div>
                            <div class="won_box" id="bagBox">
                                <p style="margin-right: 10px">ë´‰íˆ¬</p>
                                <p><l id="bagAmount"></l> ì›</p>
                            </div>
                            <hr />
                            <div class="won_box">
                                <p style="margin-right: 10px">í•©ê³„</p>
                                <p><b id="totalAmount">{{ book.amount|intcomma  }} </b> ì›</p>
                            </div>
                        </div>
                        <button id="pickupButton" class="all-btn">í”½ì—… ì£¼ë¬¸ (1)</button>
                    </div>
                    
                </div>
            </div>
        </div>

        <br />

        <div id="myModal" class="modal">
            <di class="modal-content">
                <div class="won_box">
                    <h5><b>ì•ˆë‚´</b></h5>
                    <span class="close">&times;</span>  
                </div>
                <br>
                <div class="modeal_box">
                    <b>í•œì–‘ì—¬ëŒ€ì„œì </b>
                    <br>
                    <h6>8ì‹œ 30ë¶„ë¶€í„° ìˆ˜ë ¹ ê°€ëŠ¥</h6>
                    ---
                    <br>
                    <h6>í”½ì—… ì¡´ì—ì„œ ì¤€ë¹„ëœ ìƒí’ˆ ë°›ê¸°</h6>
                </div>
                <br>
                    <h6>1ê°œì˜ ìƒí’ˆì„ ì¤€ë¹„í•©ë‹ˆë‹¤.</h6>
                <br>
                <div class="button-containe">
                    <a><button id="cancelBtn" class="all-btn" style=" background-color: #aaa;">ì·¨ì†Œ</button></a>
                    <a href="{% url 'pick_up_buy' book.id %}"><button id="confirmBtn" class="all-btn" style="background-color: #18288dbb;">í™•ì¸</button></a>
                </div>
            </div>
        </div>
            
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // Get the modal
                var modal = document.getElementById('myModal');

                // Get the button that opens the modal
                var pickupButton = document.getElementById('pickupButton');

                // Get the <span> element that closes the modal
                var span = document.getElementsByClassName('close')[0];

                // Get the cancel and confirm buttons
                var cancelBtn = document.getElementById('cancelBtn');
                var confirmBtn = document.getElementById('confirmBtn');

                // When the user clicks the button, open the modal
                pickupButton.onclick = function () {
                    modal.style.display = 'block';
                };

                // When the user clicks on <span> (x), close the modal
                span.onclick = function () {
                    modal.style.display = 'none';
                };

                // When the user clicks cancel, close the modal
                cancelBtn.onclick = function () {
                    modal.style.display = 'none';
                };

                // When the user clicks confirm, navigate to another page
                confirmBtn.onclick = function () {
                    // Add your logic to navigate to another page here
                    // For example, you can use window.location.href
                    window.location.href = '/your/other/page';
                };

                // When the user clicks anywhere outside of the modal, close it
                window.onclick = function (event) {
                    if (event.target == modal) {
                        modal.style.display = 'none';
                    }
                };
            });
        </script>
        <script>
            // ë´‰íˆ¬ ì„ íƒ ì—¬ë¶€ì— ë”°ë¼ ê°€ê²©ì„ ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
            function updateTotalAmount() {
                var bookAmount = parseFloat("{{ book.amount }}");
                var bagAmount = 0; // Default value is 0 for "ì„ íƒì•ˆí•¨"

                // Check if the "ë´‰íˆ¬(+100ì›)" radio button is checked
                var withBagCheckbox = document.getElementById('with-bag');
                if (withBagCheckbox.checked) {
                    bagAmount = 100;
                }

                // Calculate total amount
                var totalAmount = bookAmount + bagAmount;

                // Format numbers with Korean currency style
                var formattedBookAmount = bookAmount.toLocaleString('ko-KR');
                var formattedBagAmount = bagAmount.toLocaleString('ko-KR');
                var formattedTotalAmount = totalAmount.toLocaleString('ko-KR');

                // ê° í•­ëª©ì˜ ê¸ˆì•¡ ì—…ë°ì´íŠ¸
                document.getElementById('bagAmount').innerText = `+ ${formattedBagAmount} `;
                document.getElementById('totalAmount').innerText = `${formattedTotalAmount}`;
            }

            // ë´‰íˆ¬ ì²´í¬ë°•ìŠ¤ì˜ ìƒíƒœê°€ ë³€ê²½ë  ë•Œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ í˜¸ì¶œ
            document.getElementById('not-selected').addEventListener('change', updateTotalAmount);
            document.getElementById('with-bag').addEventListener('change', updateTotalAmount);

            // ì´ˆê¸°í™”ë©´ì—ì„œë„ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ í˜¸ì¶œ
            updateTotalAmount();
        </script>
    </body>
    {% endblock %}
</html>
