<!DOCTYPE html>
<html lang="en">

{% extends 'base.html' %}
{% block content %}
{% load static %}
{% load humanize %}


<link rel="stylesheet" href="{% static 'web_app/assets/css/styles.css' %}" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2Xof8EhsflZzvCq8C4N8/grFVKhDAj2RGbAy"
      crossorigin="anonymous">
<link rel="stylesheet" href="static/practice.css" />
<br>
<br>
<style>
    .bookimg {
        width: 30%;
    }

    .book-description {
        margin-left: 15%;
    }
    .detail-images {
        display: flex;
        flex-direction: column; 
        justify-content: center; 
        align-items: center;
        gap: 10px; 
        max-width: 80%; 
        margin: 0 auto;
    }

    .detailimg{
        width:40%;
    }

</style>
<body class="page-specific">   
    <div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="centered-container">
                <div class="centered-div">
                    <h3 class="center-text">{{ used_book.title }}</h3>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="book-main">
        <div class="book-container">
            <button class="all-btn" data-toggle="modal" data-target="#deleteModal">Delete</button>
<form method="post" action="{% url 'edit_book' used_book.id %}" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <div class="btn">
        <button type="submit" class="all-btn" onclick="showSuccessPopup()">수정</button>
    </div>
</form>
        <img class="book-image">
        <img src="{{ used_book.image.url }}" class="bookimg" alt="{{ used_book.title }} 이미지">
    </div>

    <div class="book-details">
        <p class="price_left">저자: {{ used_book.author }}</p> <br>
        <hr class="d-hr">
        <h6 class="price_left">학과: {{ used_book.category }}</h6> <br>
        <hr class="d-hr">
        <p class="price_left">가격:<b>{{ used_book.price|intcomma }}원</b></p> <br>
        <hr class="d-hr">
        <p class="price_left">재고: 1권</p> <br>
        <!-- <hr class="d-hr">
        <h6 class="price_left">판매자와 연락하기</h6> <br> -->

    </div>
</div>

<br><hr><br>

<p class="card-text"> {{ used_book.description }} </p>
<!-- <div class="detail-images">
    {% for image in detail_images %}
        <img src="{{ image.image.url }}"class="detailimg" alt="Detail Image">
    {% endfor %}
</div> -->
<div class="detail-images">
    {% for image in used_book.detail_images.all %}
        <img src="{{ image.image.url }}" class="detailimg" alt="Detail Image">
    {% endfor %}
</div>
<!-- <div class="detail-images">
    {% for image in used_book.detail_images.all %}
        <img src="{{ image.image.url }}" class="detailimg" alt="Detail Image">
    {% endfor %}
</div> -->



<br><br><br>
<div class="clearfix">
    <div class="book-box">금액: <b>{{ used_book.price|intcomma }}원</b></div>

    <div class="book-button">
        <!-- <button id="add-heart" class="all-btn" data-book-id="{{ used_book.id }}">관심</button>
        <button id="add-cart" data-book-id="{{ used_book.id }}" class="all-btn" >장바구니</button> -->
        <button class="all-btn">채팅하기</button>
    </div>
</div>

<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Delete Book</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>'{{ used_book.title }}'을(를) 정말 삭제하시겠습니까?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <form method="post" action="{% url 'delete_book' used_book.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $("#add-heart").click(function () {
            var bookId = $(this).data("used-id");
            $.ajax({
                url: "/add_interest/" + bookId + "/",
                type: "POST",
                success: function (data) {
                    window.location.href = '/my_info_app_url/';
                },
            });
        });

        $("#add-cart").click(function () {
            var bookId = $(this).data("book-id");
            $.ajax({
                url: "/add_to_cart/" + bookId + "/",
                type: "POST",
                success: function (data) {
                    // 처리 완료 후에 원하는 동작 수행
                },
            });
        });
    });
</script>

    <style>
        * {
  margin: 0;
  padding: 0;
}
ul,
li {
  list-style: none;
}

.comment {
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  padding: 30px;
  width: 600px;
  margin: 0 auto;
}

.comment > li {
  margin-top: 20px;
}
.comment > li:nth-child(1) {
  margin: 0px;
}

.comment-row {
  display: flex;
  justify-content: space-between;
  flex-direction: row;
}

.comment-row {
  margin-top: 20px;
  width: 100%;
}

.comment-row > li:nth-child(2) {
  flex-shrink: 0;
  flex-grow: 1;
  padding-left: 25px;
  z-index: 1;
  width: 100%;
}

.comment-row > li:nth-child(2) {
  width: 85px;
}

.comment-form > form {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: space-between;
}

.comment-form > form > h4 {
  width: 100%;
  margin: 14px 0 14px 0;
}

.comment-content {
  cursor: pointer;
  word-break: break-all;
  padding-right: 25px;
}

.ps_box {
  display: block;
  position: relative;
  width: 80%;
  height: 51px;
  border: solid 1px #dadada;
  padding: 10px 14px 10px 14px;
  background: #fff;
  box-sizing: border-box;
}

.ps_box > input {
  outline: none;
}

.int {
  display: block;
  position: relative;
  width: 100%;
  height: 29px;
  padding-right: 25px;
  line-height: 29px;
  border: none;
  background: #fff;
  font-size: 15px;
  box-sizing: border-box;
  z-index: 10;
}

.btn {
  width: 18%;
  padding: 18px 0 16px;
  text-align: center;
  box-sizing: border-box;
  text-decoration: none;
  border: none;
  background: #333;
  color: #fff;
  font-size: 14px;
}

.comment-delete-btn {
  display: inline-block;
  margin-left: 7px;
  cursor: pointer;
}

.comment-update-input {
  border: none;
  border-bottom: 1px solid #333;
  font-size: 16px;
  color: #666;
  outline: none;
}
    </style>
    <div>
      <ul class="comment">
        <li class="comment-form">
          <form id="commentFrm">
            <h4>댓글쓰기 <span></span></h4>
            <span class="ps_box">
              <input type="text" placeholder="댓글 내용을 입력해주세요." class="int" name="content" />
            </span>
            <input type="submit" class="btn" value="등록" />
          </form>
        </li>
        <li id="comment-list"></li>
      </ul>
    </div>
    <script src="{% static 'practice.js' %}"></script>

</body>
{% endblock %}

</html>
